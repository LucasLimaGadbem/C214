"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _freeze = require("babel-runtime/core-js/object/freeze");

var _freeze2 = _interopRequireDefault(_freeze);

var _map = require("babel-runtime/core-js/map");

var _map2 = _interopRequireDefault(_map);

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var EqualArray = function () {
  function EqualArray() {
    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
        conversion = _ref.conversion,
        returnArray = _ref.returnArray;

    (0, _classCallCheck3.default)(this, EqualArray);

    this._root = new _map2.default();
    this._id = 0;
    switch (conversion) {
      case undefined:
        this._convert = function (element) {
          return element ? element.valueOf() : element;
        };break;
      case false:
        this._convert = function (element) {
          return element;
        };break;
      default:
        this._convert = conversion;
    }
    this._returnArray = returnArray;
    return this.eq.bind(this);
  }

  (0, _createClass3.default)(EqualArray, [{
    key: "eq",
    value: function eq(arr) {
      var node = this._root;
      for (var i = 0; i < arr.length; ++i) {
        var value = this._convert(arr[i]);
        if (node.has(value)) {
          node = node.get(value);
        } else {
          var child = new _map2.default();
          node.set(value, child);
          node = child;
        }
      }
      if (node.returned === undefined) {
        if (this._returnArray) {
          node.returned = (0, _freeze2.default)(arr.slice());
        } else {
          node.returned = this._id++;
        }
      }
      return node.returned;
    }
  }]);
  return EqualArray;
}();

exports.default = EqualArray;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lcXVhbC1hcnJheS5qcyJdLCJuYW1lcyI6WyJFcXVhbEFycmF5IiwiY29udmVyc2lvbiIsInJldHVybkFycmF5IiwiX3Jvb3QiLCJfaWQiLCJ1bmRlZmluZWQiLCJfY29udmVydCIsImVsZW1lbnQiLCJ2YWx1ZU9mIiwiX3JldHVybkFycmF5IiwiZXEiLCJiaW5kIiwiYXJyIiwibm9kZSIsImkiLCJsZW5ndGgiLCJ2YWx1ZSIsImhhcyIsImdldCIsImNoaWxkIiwic2V0IiwicmV0dXJuZWQiLCJzbGljZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBQXFCQSxVO0FBRW5CLHdCQUE0QztBQUFBLG1GQUFKLEVBQUk7QUFBQSxRQUEvQkMsVUFBK0IsUUFBL0JBLFVBQStCO0FBQUEsUUFBbkJDLFdBQW1CLFFBQW5CQSxXQUFtQjs7QUFBQTs7QUFDMUMsU0FBS0MsS0FBTCxHQUFhLG1CQUFiO0FBQ0EsU0FBS0MsR0FBTCxHQUFXLENBQVg7QUFDQSxZQUFRSCxVQUFSO0FBQ0csV0FBS0ksU0FBTDtBQUFpQixhQUFLQyxRQUFMLEdBQWdCO0FBQUEsaUJBQVdDLFVBQVVBLFFBQVFDLE9BQVIsRUFBVixHQUE4QkQsT0FBekM7QUFBQSxTQUFoQixDQUFrRTtBQUNwRixXQUFLLEtBQUw7QUFBYSxhQUFLRCxRQUFMLEdBQWdCO0FBQUEsaUJBQVdDLE9BQVg7QUFBQSxTQUFoQixDQUFvQztBQUNqRDtBQUFVLGFBQUtELFFBQUwsR0FBZ0JMLFVBQWhCO0FBSFo7QUFLQSxTQUFLUSxZQUFMLEdBQW9CUCxXQUFwQjtBQUNBLFdBQU8sS0FBS1EsRUFBTCxDQUFRQyxJQUFSLENBQWEsSUFBYixDQUFQO0FBQ0Q7Ozs7dUJBRUVDLEcsRUFBSztBQUNOLFVBQUlDLE9BQU8sS0FBS1YsS0FBaEI7QUFDQSxXQUFLLElBQUlXLElBQUksQ0FBYixFQUFnQkEsSUFBSUYsSUFBSUcsTUFBeEIsRUFBZ0MsRUFBRUQsQ0FBbEMsRUFBcUM7QUFDbkMsWUFBTUUsUUFBUSxLQUFLVixRQUFMLENBQWNNLElBQUlFLENBQUosQ0FBZCxDQUFkO0FBQ0EsWUFBSUQsS0FBS0ksR0FBTCxDQUFTRCxLQUFULENBQUosRUFBcUI7QUFDbkJILGlCQUFPQSxLQUFLSyxHQUFMLENBQVNGLEtBQVQsQ0FBUDtBQUNELFNBRkQsTUFFTztBQUNMLGNBQU1HLFFBQVEsbUJBQWQ7QUFDQU4sZUFBS08sR0FBTCxDQUFTSixLQUFULEVBQWdCRyxLQUFoQjtBQUNBTixpQkFBT00sS0FBUDtBQUNEO0FBQ0Y7QUFDRCxVQUFJTixLQUFLUSxRQUFMLEtBQWtCaEIsU0FBdEIsRUFBaUM7QUFDL0IsWUFBSSxLQUFLSSxZQUFULEVBQXVCO0FBQ3JCSSxlQUFLUSxRQUFMLEdBQWdCLHNCQUFjVCxJQUFJVSxLQUFKLEVBQWQsQ0FBaEI7QUFDRCxTQUZELE1BRU87QUFDTFQsZUFBS1EsUUFBTCxHQUFnQixLQUFLakIsR0FBTCxFQUFoQjtBQUNEO0FBQ0Y7QUFDRCxhQUFPUyxLQUFLUSxRQUFaO0FBQ0Q7Ozs7O2tCQWxDa0JyQixVIiwiZmlsZSI6ImVxdWFsLWFycmF5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXF1YWxBcnJheSB7XG5cbiAgY29uc3RydWN0b3Ioe2NvbnZlcnNpb24sIHJldHVybkFycmF5fSA9IHt9KSB7XG4gICAgdGhpcy5fcm9vdCA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLl9pZCA9IDA7XG4gICAgc3dpdGNoIChjb252ZXJzaW9uKSB7XG4gICAgICAgY2FzZSB1bmRlZmluZWQgOiB0aGlzLl9jb252ZXJ0ID0gZWxlbWVudCA9PiBlbGVtZW50ID8gZWxlbWVudC52YWx1ZU9mKCkgOiBlbGVtZW50OyBicmVhaztcbiAgICAgIGNhc2UgZmFsc2UgOiB0aGlzLl9jb252ZXJ0ID0gZWxlbWVudCA9PiBlbGVtZW50OyBicmVhaztcbiAgICAgIGRlZmF1bHQgOiB0aGlzLl9jb252ZXJ0ID0gY29udmVyc2lvbjtcbiAgICB9XG4gICAgdGhpcy5fcmV0dXJuQXJyYXkgPSByZXR1cm5BcnJheTtcbiAgICByZXR1cm4gdGhpcy5lcS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgZXEoYXJyKSB7XG4gICAgbGV0IG5vZGUgPSB0aGlzLl9yb290O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgKytpKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX2NvbnZlcnQoYXJyW2ldKTtcbiAgICAgIGlmIChub2RlLmhhcyh2YWx1ZSkpIHtcbiAgICAgICAgbm9kZSA9IG5vZGUuZ2V0KHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gbmV3IE1hcCgpO1xuICAgICAgICBub2RlLnNldCh2YWx1ZSwgY2hpbGQpO1xuICAgICAgICBub2RlID0gY2hpbGQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChub2RlLnJldHVybmVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh0aGlzLl9yZXR1cm5BcnJheSkge1xuICAgICAgICBub2RlLnJldHVybmVkID0gT2JqZWN0LmZyZWV6ZShhcnIuc2xpY2UoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLnJldHVybmVkID0gdGhpcy5faWQrKztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vZGUucmV0dXJuZWQ7XG4gIH1cbn1cbiJdfQ==